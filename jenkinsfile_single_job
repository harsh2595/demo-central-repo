pipeline {
  agent any

  stages {
    stage ("Build the maven war package") {
      steps {
        node ("build_server") {

          //checkout the SCM
          print ("downloading the source code from github")

          checkout scmGit(
            branches: [[name: '*/maven-brnach']], extensions: [], userRemoteConfigs: [[url: 'https://github.com/harsh2595/demo-central-repo.git']]
          )

          //delete and create a new war package
          print ("Deleting the old maven package")
          print ("creating new maven package")
          sh "mvn clean install"

          // stash the war package
          print ("prepariang war package to copy to the deploy server") 
          dir("/home/ubuntu/build_server/workspace/single_job_pipeline/target/") {
           stash( includes: "hello-world-webapp.war", name: "packagee-maven")
         }
        }
      }
    }

     
  }
}
